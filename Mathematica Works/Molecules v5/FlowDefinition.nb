(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     26918,        687]
NotebookOptionsPosition[     26619,        674]
NotebookOutlinePosition[     26962,        689]
CellTagsIndexPosition[     26919,        686]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearVars", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"QV", "[", "rlx", "]"}], ",", 
       RowBox[{"Clear", "@@", 
        RowBox[{"rlx", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"A", ",", "B"}], "]"}], ";"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetVars", "[", "n_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"namen", "=", 
     RowBox[{"n", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", " ", "[", 
     RowBox[{
      RowBox[{"namen", "\[NotEqual]", "0"}], ",", 
      RowBox[{"name", "=", "namen"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"els", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"GetEls", "[", "name", "]"}], "/.", 
       RowBox[{"\"\<T\>\"", "\[Rule]", "\"\<H\>\""}]}], "/.", 
      RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Sep", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Working on: \>\"", ",", "name"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "[", "\"\<Getting info..\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"dv1", "=", 
     RowBox[{"IQ", "[", 
      RowBox[{"n", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dv2", "=", 
     RowBox[{"IQ", "[", 
      RowBox[{"n", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"LD", "=", 
     RowBox[{
      FractionBox["1", "2"], 
      RowBox[{"n", "[", 
       RowBox[{"[", "4", "]"}], "]"}], "an"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ED", "=", 
     RowBox[{"n", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"P", "=", 
     RowBox[{
      RowBox[{"n", "[", 
       RowBox[{"[", "6", "]"}], "]"}], "deb"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"EH", "=", 
     RowBox[{"n", "[", 
      RowBox[{"[", "7", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"EO", "=", 
     RowBox[{"n", "[", 
      RowBox[{"[", "8", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tv1", "=", 
     RowBox[{"GetGr", "[", 
      RowBox[{"QM", "[", 
       RowBox[{"ElementData", "[", 
        RowBox[{
         RowBox[{"els", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<Group\>\""}], "]"}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"tv2", "=", 
     RowBox[{"GetGr", "[", 
      RowBox[{"QM", "[", 
       RowBox[{"ElementData", "[", 
        RowBox[{
         RowBox[{"els", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Group\>\""}], "]"}], 
       "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rf1", "=", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"rT", "[", 
        RowBox[{"[", 
         RowBox[{"QM", "[", 
          RowBox[{"ElementData", "[", 
           RowBox[{
            RowBox[{"els", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AtomicNumber\>\""}], 
           "]"}], "]"}], "]"}], "]"}], "]"}], 
      FractionBox["1", "LD"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rf2", "=", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"rT", "[", 
        RowBox[{"[", 
         RowBox[{"QM", "[", 
          RowBox[{"ElementData", "[", 
           RowBox[{
            RowBox[{"els", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<AtomicNumber\>\""}], 
           "]"}], "]"}], "]"}], "]"}], "]"}], 
      FractionBox["1", "LD"]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mA", "=", 
     RowBox[{
      RowBox[{"QM", "[", 
       RowBox[{"ElementData", "[", 
        RowBox[{
         RowBox[{"els", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<AtomicWeight\>\""}], 
        "]"}], "]"}], "un"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"mB", "=", 
     RowBox[{
      RowBox[{"QM", "[", 
       RowBox[{"ElementData", "[", 
        RowBox[{
         RowBox[{"els", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<AtomicWeight\>\""}], 
        "]"}], "]"}], "un"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"EO", "=", 
     RowBox[{"EH", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"EH", ",", "EO"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"dv", "=", 
     RowBox[{"Floor", "[", 
      FractionBox[
       RowBox[{"dv1", "+", "dv2"}], "2"], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"rmod", "=", 
     RowBox[{
      FractionBox["rf1", 
       RowBox[{"rf1", "+", "rf2"}]], "*", "2"}]}], ";"}], 
   "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PrepareCalculations", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"AQLIST", "=", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"AQ1", "=", 
          RowBox[{"Er", "[", 
           RowBox[{
            FractionBox[
             RowBox[{"e2", " ", "dion"}], 
             RowBox[{"it", "*", "LD"}]], ",", "EH"}], "]"}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AQ1", "=", 
         RowBox[{"Er", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"k", " ", "e2", " ", 
             RowBox[{"dIon", "[", 
              RowBox[{"io", ",", "i1q"}], "]"}]}], "LD"], ",", "EH"}], 
          "]"}]}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{"AQ2", "=", "0"}], "\[IndentingNewLine]", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AQ3", " ", "=", 
         RowBox[{"Er", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"k", " ", "e2", " ", 
             RowBox[{"dDis", "[", 
              RowBox[{"A", ",", "dq"}], "]"}]}], "LD"], ",", "ED"}], "]"}]}], 
        "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"P", "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"AQ4", "=", 
           RowBox[{"Er", "[", 
            RowBox[{
             RowBox[{
              SqrtBox["k"], "e1", " ", "LD", " ", 
              RowBox[{"dDim", "[", "pq", "]"}]}], ",", "P"}], "]"}]}], 
          "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
          RowBox[{"AQ4", "=", "0"}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"EQ", "=", 
      RowBox[{"TotPow", "[", 
       RowBox[{"AQLIST", ",", "pow"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
    ")"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetMagnetism", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Getting coefficients..\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e2temp", "=", "e2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LDtemp", "=", "LD"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"e2", ",", "LD", ",", "s", ",", "f", ",", "g", ",", "h"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"coef", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"sign", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UD", "=", 
         RowBox[{"HoldForm", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"k", " ", "e2"}], "LD"], "*", 
           RowBox[{"dIon", "[", 
            RowBox[{"in", ",", 
             RowBox[{"mq", "/.", 
              RowBox[{"i", "\[Rule]", "in"}]}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"in", "=", 
         RowBox[{"LR", "[", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sign", "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "s"}], ")"}]}], ",", "0", ",", "0"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UDP", "=", 
         RowBox[{"QR", "[", "UD", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"in", "=", 
         RowBox[{"LR", "[", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sign", "*", 
              RowBox[{"(", 
               RowBox[{"1", "-", "s"}], ")"}]}], ",", "0", ",", "0"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UDN", "=", 
         RowBox[{"QR", "[", "UD", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"in", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"UD0", "=", 
         RowBox[{"QR", "[", "UD", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"UV", "=", 
         RowBox[{"UDN", "+", "UDP", "-", 
          RowBox[{"2", "UD0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UP", "=", 
         FractionBox[
          RowBox[{"UDP", "-", "UDN"}], "2"]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"sf", "=", 
         RowBox[{"D", "[", 
          RowBox[{"UV", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"D", "[", 
          RowBox[{"UP", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sh", "=", 
         RowBox[{"D", "[", 
          RowBox[{"UV", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"sf", "/", 
          SuperscriptBox["LD", "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"g", "=", 
         RowBox[{"sg", "/", 
          SuperscriptBox["LD", "3"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"h", "=", 
         RowBox[{"sh", "/", 
          SuperscriptBox["LD", "4"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"dr", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "2"]}], "*", 
             FractionBox["g", 
              SuperscriptBox["f", "2"]], "\[Micro]", " ", "H"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"2", " ", "g", " ", "h"}], 
                RowBox[{"3", " ", 
                 SuperscriptBox["f", "4"]}]], "-", 
               FractionBox[
                RowBox[{"5", 
                 SuperscriptBox["g", "3"]}], 
                RowBox[{"8", 
                 SuperscriptBox["f", "5"]}]]}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Micro]", " ", "H"}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"185", 
                 SuperscriptBox["g", "3"], "h"}], 
                RowBox[{"48", 
                 SuperscriptBox["f", "7"]}]], "-", 
               FractionBox[
                RowBox[{"15", 
                 SuperscriptBox["g", "5"]}], 
                RowBox[{"8", 
                 SuperscriptBox["f", "8"]}]], "-", 
               FractionBox[
                RowBox[{"11", "g", " ", 
                 SuperscriptBox["h", "2"]}], 
                RowBox[{"8", 
                 SuperscriptBox["f", "6"]}]]}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Micro]", " ", "H"}], ")"}], "3"]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"\[Chi]", "=", 
           FractionBox[
            RowBox[{"dr", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "v"}], "+", 
               RowBox[{
                FractionBox[
                 RowBox[{"v", " ", "r"}], 
                 RowBox[{"12", " ", "f", " ", "g"}]], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"5", 
                   SuperscriptBox["g", "2"]}], "-", 
                  RowBox[{"3", "f", " ", "h"}]}], ")"}]}]}], ")"}]}], "H"]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"coef", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "g", ",", "h"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{
         "s", ",", "sf", ",", "sg", ",", "sh", ",", "f", ",", "g", ",", "h"}],
          "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "KER"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"e2", "=", "e2temp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LD", "=", "LDtemp"}], ";"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Calculate", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Calculating..\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SOL", "=", 
      RowBox[{"{", 
       RowBox[{"1000", ",", 
        RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SOLB", "=", "SOL"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Clear", "@@", 
         RowBox[{"rlx", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rlx", "=", 
         RowBox[{"ParseRules", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"iter", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SOL", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "minerr"}], "&&", 
           RowBox[{"iter", "<", "tries"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Clear", "@@", 
            RowBox[{"rlx", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"SOL", "=", 
            RowBox[{"FindMinimum", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"EQ", ",", 
                RowBox[{"rlx", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
              RowBox[{"QR", "[", 
               RowBox[{"rlx", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
              RowBox[{"MaxIterations", "\[Rule]", "5000"}], ",", 
              RowBox[{"AccuracyGoal", "\[Rule]", "10"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<SOLC: \>\"", ",", "SOL"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"QS", "[", 
              RowBox[{"i", ",", 
               RowBox[{
                RowBox[{"QG", "[", "i", "]"}], "/.", 
                RowBox[{"SOL", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"rlx", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"iter", "=", 
            RowBox[{"iter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"coef", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}], "<=", "0"}], "||", 
                RowBox[{
                 RowBox[{"coef", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], "<=", "0"}]}], 
               ")"}], "&&", 
              RowBox[{"TestMode", "\[Equal]", "0"}]}], ",", 
             RowBox[{"SOL", "=", 
              RowBox[{"{", 
               RowBox[{"1000", ",", 
                RowBox[{"{", "}"}]}], "}"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SOL", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{"SOLB", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"SOLB", "=", "SOL"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SOL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", "minerr"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "rules"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyResults", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Print", "[", "\"\<Applying Results..\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Solval: \>\"", ",", 
       RowBox[{"SOL", "=", "SOLB"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"QS", "[", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"QG", "[", "i", "]"}], "/.", 
          RowBox[{"SOL", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"rlx", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Acc:\>\"", ",", "AQLIST"}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintGeo", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", "\"\<-----Geogebra output:-----\>\"", "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"GPPrint", "[", 
     RowBox[{"\"\<Red\>\"", ",", "KER"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"GeoLPrint", "[", 
     RowBox[{
     "\"\<AB\>\"", ",", "\"\<A\>\"", ",", "\"\<B\>\"", ",", "\"\<Red\>\"", 
      ",", "5", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"GPrint", "[", 
     RowBox[{"\"\<Blue\>\"", ",", "ox1"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"GPrint", "[", 
     RowBox[{"\"\<Green\>\"", ",", "ox2"}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"GPrint", "[", 
     RowBox[{"\"\<Cyan\>\"", ",", "ix"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dv", "<", "3"}], ",", 
       RowBox[{
        RowBox[{"A3", "=", "\"\<X\>\""}], ";", 
        RowBox[{"B3", "=", "\"\<X\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dv", "<", "2"}], ",", 
       RowBox[{
        RowBox[{"A2", "=", "\"\<X\>\""}], ";", 
        RowBox[{"B2", "=", "\"\<X\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RXX", "[", "x_", "]"}], ":=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"10", "x"}], ",", "0.000000001"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RX", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", " ", "@", "x"}], "\[Equal]", "String"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"\"\<X\>\"", ",", "\"\<X\>\"", ",", "\"\<X\>\""}], "}"}],
             ")"}], "]"}]}], "]"}], ";", 
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IQ", "[", 
            RowBox[{"RXX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"IQ", "[", 
            RowBox[{"RXX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"IQ", "[", 
            RowBox[{"RXX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}], ")"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"A1", "=", 
      RowBox[{"RX", "[", "A1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A2", "=", 
      RowBox[{"RX", "[", "A2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A3", "=", 
      RowBox[{"RX", "[", "A3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B1", "=", 
      RowBox[{"RX", "[", "B1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B2", "=", 
      RowBox[{"RX", "[", "B2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B3", "=", 
      RowBox[{"RX", "[", "B3", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"j", "=", 
      RowBox[{
       FractionBox["1", "mA"], "+", 
       FractionBox["1", "mB"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]A", "=", 
      RowBox[{"c", 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]B", "=", 
      RowBox[{"c", 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Micro]A", "=", 
      RowBox[{
       FractionBox["e1", "2"], "*", "4", 
       SuperscriptBox["LD", "2"], 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Micro]B", "=", 
      RowBox[{
       FractionBox["e1", "2"], "*", "4", 
       SuperscriptBox["LD", "2"], 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]\[Micro]", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"\[Micro]A", "-", "\[Micro]B"}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]", 
 RowBox[{";", "\[IndentingNewLine]"}]}], "Input",
 CellChangeTimes->{{3.7848114955258503`*^9, 3.784811532821766*^9}, {
   3.784811566313727*^9, 3.7848116005336857`*^9}, {3.784811643965646*^9, 
   3.784811733417571*^9}, 3.784811778077479*^9, {3.784811908769329*^9, 
   3.7848119162253428`*^9}, {3.784813081565324*^9, 3.78481308625732*^9}, {
   3.7848141976234612`*^9, 3.784814218255414*^9}, 3.784814378029768*^9, {
   3.784815814827255*^9, 3.784815875671184*^9}, {3.784816099842952*^9, 
   3.784816106262955*^9}, {3.784816447079745*^9, 3.7848164504597793`*^9}, 
   3.7848172673077126`*^9, {3.7848175689125905`*^9, 3.784817661434052*^9}, {
   3.784817801467346*^9, 3.7848178185193677`*^9}, 3.78584521129819*^9, {
   3.785845511967913*^9, 3.7858455123758216`*^9}, {3.7858455437369566`*^9, 
   3.7858455870351696`*^9}, {3.785845710830409*^9, 3.785845711860656*^9}, 
   3.78584768316004*^9, 3.7858482286626062`*^9, {3.78781168421297*^9, 
   3.7878117158928924`*^9}, {3.7878163123559227`*^9, 3.787816312701996*^9}, {
   3.7879869820219145`*^9, 3.7879870516239276`*^9}, {3.78798713804226*^9, 
   3.787987172065691*^9}, 3.7880081567067213`*^9, {3.78801733230276*^9, 
   3.788017537226756*^9}, {3.788017571135079*^9, 3.7880176214016857`*^9}, {
   3.7880176971101985`*^9, 3.7880177901653814`*^9}, {3.7880178380502973`*^9, 
   3.7880179071375756`*^9}, {3.7880179509194655`*^9, 3.788018097055094*^9}, 
   3.7880650698140016`*^9, {3.7880652089176426`*^9, 3.788065305640698*^9}, {
   3.788065658586488*^9, 3.7880656588059263`*^9}, {3.7880662538104253`*^9, 
   3.788066257080681*^9}, {3.788066296193936*^9, 3.7880662966566973`*^9}, {
   3.7880664841750755`*^9, 3.7880666209195747`*^9}, {3.7880668748978424`*^9, 
   3.788066988257506*^9}, {3.7880670256615996`*^9, 3.788067084908166*^9}, {
   3.788067115990044*^9, 3.788067119545537*^9}, {3.7880671731154184`*^9, 
   3.7880671953629236`*^9}, {3.7880672427463875`*^9, 
   3.7880672527117367`*^9}, {3.7880675541888494`*^9, 3.7880675832480316`*^9}, 
   3.7880676723246813`*^9, {3.788068822831566*^9, 3.788068834753684*^9}, {
   3.788068986375286*^9, 3.7880690120427866`*^9}, {3.788069354986252*^9, 
   3.788069455099353*^9}, {3.78807234132927*^9, 3.7880723607274284`*^9}, {
   3.7880731283327274`*^9, 3.788073243880273*^9}, {3.788073319149774*^9, 
   3.7880733256972632`*^9}, {3.788073416200502*^9, 3.788073421118351*^9}, 
   3.7880734679780397`*^9, {3.7880735697644496`*^9, 3.788073571497817*^9}, {
   3.788073701869273*^9, 3.7880737024447355`*^9}, {3.7880738926927543`*^9, 
   3.788073897942712*^9}, {3.788074025767095*^9, 
   3.7880740260982084`*^9}},ExpressionUUID->"ad78d8e7-3118-4dbb-a100-\
d764b1c9bd1b"]
},
WindowSize->{775, 872},
WindowMargins->{{Automatic, 170}, {Automatic, 42}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 26057, 652, 3485, "Input",ExpressionUUID->"ad78d8e7-3118-4dbb-a100-d764b1c9bd1b"]
}
]
*)

