(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12781,        277]
NotebookOptionsPosition[     12481,        264]
NotebookOutlinePosition[     12825,        279]
CellTagsIndexPosition[     12782,        276]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"SetGeometry", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"P", "\[Equal]", "0"}], ",", 
      RowBox[{"xa", "=", "0"}], ",", 
      RowBox[{"Clear", "[", "xa", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"rules", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "<", "xa", "<", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"0.15", "<", "ya", "<", "1.2"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", "<", "k", "<", "10"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "<", "xa", "<", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"1.2", "<", "ya", "<", "1.75"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", "<", "k", "<", "10"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "<", "xa", "<", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"1.75", "<", "ya", "<", "2.75"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", "<", "k", "<", "10"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "<", "xa", "<", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"0", "<", "ya", "<", "0.15"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", "<", "k", "<", "10"}]}], "\[IndentingNewLine]", "}"}], 
       "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "1"}], "<", "xa", "<", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"2.75", "<", "ya", "<", "4"}], ",", "\[IndentingNewLine]", 
         RowBox[{"0", "<", "k", "<", "10"}]}], "\[IndentingNewLine]", "}"}]}],
       "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"dvlst", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "3"}], "}"}], "[", 
      RowBox[{"[", 
       RowBox[{"1", ";;", 
        RowBox[{"dv", "-", "1"}]}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"dv1", "\[Equal]", "dv2"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cond", "=", 
        RowBox[{"HoldForm", "[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"i", ",", "2"}], "]"}], "\[Equal]", "0"}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cond", "=", 
        RowBox[{"HoldForm", "[", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dv1", ">", "dv2"}], ",", 
           RowBox[{"MemberQ", "[", 
            RowBox[{"dvlst", ",", "i"}], "]"}], ",", 
           RowBox[{"!", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"dvlst", ",", "i"}], "]"}]}]}], "]"}], "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"XX", "=", 
     RowBox[{"{", 
      RowBox[{"xa", ",", "ya", ",", "0"}], "}"}]}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"AB", "=", 
     RowBox[{"BA", "=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ab", "=", 
     RowBox[{"ba", "=", "0"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"KER", "=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"A", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", "dv1", ",", 
          "1", ",", "mA", ",", "\"\<A\>\""}], "}"}]}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"B", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "dv2", ",", "2", 
          ",", "mB", ",", "\"\<B\>\""}], "}"}]}]}], "\[IndentingNewLine]", 
      "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"QR", "[", "cond", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"AB", ",", 
           RowBox[{
            RowBox[{"ab", "+=", "1"}], ";", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Rot", "[", 
               RowBox[{"XX", ",", 
                RowBox[{"i", "*", 
                 FractionBox["\[Pi]", "dv"]}], ",", "1"}], "]"}], ",", 
              RowBox[{"-", "1"}], ",", "1", ",", "me", ",", 
              RowBox[{"\"\<AB\>\"", "<>", 
               RowBox[{"ToString", "[", "ab", "]"}]}]}], "}"}]}]}], "]"}], 
         ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"BA", ",", 
           RowBox[{
            RowBox[{"ba", "+=", "1"}], ";", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Rot", "[", 
               RowBox[{"XX", ",", 
                RowBox[{"i", "*", 
                 FractionBox["\[Pi]", "dv"]}], ",", "1"}], "]"}], ",", 
              RowBox[{"-", "1"}], ",", "2", ",", "me", ",", 
              RowBox[{"\"\<BA\>\"", "<>", 
               RowBox[{"ToString", "[", "ba", "]"}]}]}], "}"}]}]}], "]"}], 
         ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{
         RowBox[{"2", "dv"}], "-", "1"}]}], "}"}]}], "\[IndentingNewLine]", 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"ix", "=", 
     RowBox[{"Join", "[", 
      RowBox[{"AB", ",", "BA"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"ox1", "=", 
     RowBox[{"ox2", "=", 
      RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"io", "=", 
     RowBox[{"ix", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"mq", "=", 
     RowBox[{"pq", "=", 
      RowBox[{"i1q", "=", 
       RowBox[{"i2q", "=", 
        RowBox[{"dq", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"KER", ",", "ix"}], "]"}]}]}]}]}]}]}], 
   "\[IndentingNewLine]", ")"}]}]], "Input",
 CellChangeTimes->{{3.7858455945463743`*^9, 3.7858456249849734`*^9}, 
   3.7858459504236603`*^9, {3.785846054449542*^9, 3.7858460552105026`*^9}, 
   3.785846218237547*^9, {3.785846827972937*^9, 3.7858468621605186`*^9}, {
   3.7858468949049544`*^9, 3.7858469256297894`*^9}, {3.7858475347539015`*^9, 
   3.7858475378187017`*^9}, {3.7858477084925756`*^9, 3.785847761387126*^9}, {
   3.785847865924664*^9, 3.785847867457567*^9}, {3.785849861770385*^9, 
   3.785849864291664*^9}, 3.7858500192914934`*^9, {3.7858500759260445`*^9, 
   3.785850076223256*^9}, {3.7858508358683925`*^9, 3.7858508924800053`*^9}, {
   3.785851069374954*^9, 3.785851080100239*^9}, {3.785851265149413*^9, 
   3.785851349260481*^9}, {3.7858513853360105`*^9, 3.7858515075990615`*^9}, {
   3.785851559828391*^9, 3.785851560821735*^9}, {3.7858516653591814`*^9, 
   3.7858516674016867`*^9}, {3.7858518195249133`*^9, 3.78585186897966*^9}, 
   3.78585212568718*^9, {3.7858521653710575`*^9, 3.7858521675592055`*^9}, {
   3.7858522016839495`*^9, 3.78585222167648*^9}, {3.7858522778033924`*^9, 
   3.7858523051472635`*^9}, {3.785852577396217*^9, 3.7858526154175496`*^9}, {
   3.785852693989435*^9, 3.7858527286018476`*^9}, {3.785852766029784*^9, 
   3.785852803791802*^9}, {3.785852895916444*^9, 3.785852898466625*^9}, {
   3.785852981054738*^9, 3.785853003310256*^9}, {3.785853088027672*^9, 
   3.7858530973198557`*^9}, {3.7858532193983965`*^9, 3.785853224314251*^9}, {
   3.7858533078549814`*^9, 3.785853349901573*^9}, {3.785853527731435*^9, 
   3.7858535295066824`*^9}, {3.785853679054764*^9, 3.7858536794815903`*^9}, {
   3.7858538395552464`*^9, 3.7858538444421787`*^9}, 3.785854245472313*^9, {
   3.7858548981340256`*^9, 3.785854903049873*^9}, 3.7858550482867765`*^9, {
   3.785855282905439*^9, 3.785855324022483*^9}, {3.7858554843487763`*^9, 
   3.785855517966874*^9}, 3.7858555575496597`*^9, {3.785855651800573*^9, 
   3.785855653760332*^9}, 3.785855728570171*^9, 3.7858560676174774`*^9, 
   3.785856174072769*^9, 3.7858563611693864`*^9, 3.785905451302394*^9, {
   3.785906405743151*^9, 3.7859064163228607`*^9}, {3.785906781766385*^9, 
   3.785906806905151*^9}, 3.785906920582177*^9, {3.785906975436487*^9, 
   3.7859069989745398`*^9}, {3.7859070385148044`*^9, 3.785907041132801*^9}, {
   3.78590840831363*^9, 3.7859084103771076`*^9}, {3.7859085753770857`*^9, 
   3.7859085754468994`*^9}, 3.7859086280900908`*^9, {3.7859090702875757`*^9, 
   3.7859090798580055`*^9}, {3.7859138698982167`*^9, 3.785913909524251*^9}, {
   3.785914086668974*^9, 3.7859140909984207`*^9}, 3.785914244769935*^9, 
   3.785915307425039*^9, {3.7878080486159105`*^9, 3.7878080787338324`*^9}, {
   3.7878084144206715`*^9, 3.7878084613157587`*^9}, {3.7878086244775853`*^9, 
   3.787808648909342*^9}, {3.787808706603739*^9, 3.787808710462211*^9}, 
   3.787808763996499*^9, {3.7878088008159657`*^9, 3.787808804518223*^9}, {
   3.7878089033699846`*^9, 3.787808935971696*^9}, {3.787808966230338*^9, 
   3.787808993817467*^9}, {3.787809082202937*^9, 3.7878092029235597`*^9}, {
   3.7878092371655097`*^9, 3.7878092656365547`*^9}, {3.7878093124536996`*^9, 
   3.787809410254265*^9}, {3.7878094741830244`*^9, 3.787809531095544*^9}, {
   3.787809684234806*^9, 3.787809689795863*^9}, {3.7878098431187315`*^9, 
   3.7878098448214507`*^9}, {3.7878109583534956`*^9, 3.7878109611651955`*^9}, 
   3.787811053943948*^9, {3.787812347842301*^9, 3.7878123484177403`*^9}, {
   3.7878126844224253`*^9, 3.7878126847156377`*^9}, 3.787812895572809*^9, {
   3.7878134348562517`*^9, 3.7878134842860646`*^9}, {3.787813707486189*^9, 
   3.7878137442907677`*^9}, {3.7878141133568172`*^9, 
   3.7878141728058395`*^9}, {3.7878142210228977`*^9, 
   3.7878143133928833`*^9}, {3.787814580893538*^9, 3.787814619093384*^9}, {
   3.787814868973156*^9, 3.7878151074893236`*^9}, {3.7878153458199806`*^9, 
   3.787815349862172*^9}, {3.7878154389080486`*^9, 3.7878155040149417`*^9}, {
   3.7878155393235197`*^9, 3.787815539863076*^9}, {3.7878157756168365`*^9, 
   3.7878157956492662`*^9}, {3.7878159248417816`*^9, 
   3.7878159636719418`*^9}, {3.7878159967145805`*^9, 
   3.7878159981747046`*^9}, {3.7878161699248133`*^9, 3.78781617810992*^9}, {
   3.787816666339549*^9, 3.7878166708784122`*^9}, 3.787816790813682*^9, {
   3.7878168788422785`*^9, 3.787816879068673*^9}, {3.7879865955011826`*^9, 
   3.787986605853532*^9}, {3.787986761934795*^9, 3.78798683306231*^9}, {
   3.7879877404256706`*^9, 3.78798774555523*^9}, {3.7879879114499297`*^9, 
   3.7879879366422586`*^9}, {3.7880097563707647`*^9, 3.788009792054341*^9}, {
   3.7880664950639563`*^9, 3.788066496164015*^9}, 3.788072701598955*^9, 
   3.78807304205043*^9, {3.78807741611591*^9, 3.788077433495434*^9}, 
   3.7880775285128694`*^9, {3.788077805689285*^9, 3.7880778059795065`*^9}, {
   3.7880779110632834`*^9, 3.7880779159761295`*^9}, {3.78807795377205*^9, 
   3.788077957572884*^9}, {3.7880782940424013`*^9, 3.7880782983597403`*^9}, {
   3.7880783820559287`*^9, 
   3.7880783835050526`*^9}},ExpressionUUID->"382477af-70a4-4ec5-bbfb-\
35d9ce9dbfaf"]
},
WindowSize->{1143, 854},
WindowMargins->{{Automatic, 228}, {16, Automatic}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 11919, 242, 1464, "Input",ExpressionUUID->"382477af-70a4-4ec5-bbfb-35d9ce9dbfaf"]
}
]
*)

