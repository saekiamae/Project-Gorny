(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     53546,       1233]
NotebookOptionsPosition[     53118,       1218]
NotebookOutlinePosition[     53494,       1234]
CellTagsIndexPosition[     53451,       1231]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearVars", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Clear", "[", 
      RowBox[{"rax", ",", "ya", ",", "\[Kappa]"}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"APrint", "[", "x__", "]"}], ":=", 
   RowBox[{"outp", "=", 
    RowBox[{"StringJoin", "[", 
     RowBox[{"outp", ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"InputForm", "[", "i", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"List", "[", "x", "]"}]}], "}"}]}], "]"}], ",", 
      "\"\<\\n\>\""}], "]"}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"APrint", "[", "x__", "]"}], ":=", 
    RowBox[{"Print", "[", "x", "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetVars", "[", "n_", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"name", "=", "n"}], ";", "\[IndentingNewLine]", 
    RowBox[{"dt", "=", 
     RowBox[{"n", "/.", "data"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"els", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"GetEls", "[", "name", "]"}], "/.", 
       RowBox[{"\"\<T\>\"", "\[Rule]", "\"\<H\>\""}]}], "/.", 
      RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"elsx", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"GetElsx", "[", "name", "]"}], "/.", 
       RowBox[{"\"\<T\>\"", "\[Rule]", "\"\<H\>\""}]}], "/.", 
      RowBox[{"\"\<D\>\"", "\[Rule]", "\"\<H\>\""}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"objs", "=", 
     RowBox[{"elsx", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Sep", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Working on: \>\"", ",", "name"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"APrint", "[", "\"\<Getting informations..\>\"", "]"}], ";", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"molecule", "=", 
     RowBox[{"<|", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\"\<atcnt\>\"", "\[Rule]", 
        RowBox[{"QE", "[", 
         RowBox[{"\"\<atcnt\>\"", "/.", "dt"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ei\>\"", "\[Rule]", 
        RowBox[{"QE", "[", 
         RowBox[{"\"\<ion\>\"", "/.", "dt"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<dm\>\"", "\[Rule]", 
        RowBox[{
         RowBox[{"QE", "[", 
          RowBox[{"\"\<dip\>\"", "/.", "dt"}], "]"}], "*", "deb"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<ms\>\"", "\[Rule]", 
        RowBox[{"QE", "[", 
         RowBox[{"\"\<magn\>\"", "/.", "dt"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"\"\<freq\>\"", "\[Rule]", 
        RowBox[{"QE", "[", 
         RowBox[{"\"\<freq\>\"", "/.", "dt"}], "]"}]}]}], 
      "\[IndentingNewLine]", "|>"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Which", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"molecule", "[", "\"\<ei\>\"", "]"}], "\[Equal]", "ion"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"False", ",", "\"\<Ionisation\>\""}], "}"}], "]"}], ",", 
      RowBox[{
       RowBox[{"molecule", "[", "\"\<dm\>\"", "]"}], "\[Equal]", "dip"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"{", 
        RowBox[{"False", ",", "\"\<Dipole Moment\>\""}], "}"}], "]"}]}], 
     "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"bonds", "=", 
     RowBox[{"Association", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"bonds", ",", 
         RowBox[{
          RowBox[{"i", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
          RowBox[{"<|", 
           RowBox[{
            RowBox[{"\"\<elem\>\"", "\[Rule]", 
             RowBox[{"i", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{"\"\<eles\>\"", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"\"\<crg\>\"", "\[Rule]", "0"}]}], "|>"}]}]}], "]"}], 
       ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "elsx"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<leftv\>\"", "/.", "dt"}], ")"}], "\[NotEqual]", 
       "\"\<leftv\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bupd", "[", 
        RowBox[{
         RowBox[{"elsx", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"elsx", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "\"\<var\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"QE", "[", 
            RowBox[{"\"\<leftv\>\"", "/.", "dt"}], "]"}], ",", 
           RowBox[{"QE", "[", 
            RowBox[{"\"\<rightv\>\"", "/.", "dt"}], "]"}]}], "}"}]}], "]"}], 
       ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<simlen\>\"", "/.", "dt"}], ")"}], "\[NotEqual]", 
       "\"\<simlen\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bupd", "[", 
        RowBox[{
         RowBox[{"elsx", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"elsx", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "\"\<len\>\"", ",", 
         RowBox[{"QE", "[", 
          RowBox[{"\"\<simlen\>\"", "/.", "dt"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\"\<dis\>\"", "/.", "dt"}], ")"}], "\[NotEqual]", 
       "\"\<dis\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Bupd", "[", 
        RowBox[{
         RowBox[{"elsx", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"elsx", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", "\"\<dis\>\"", ",", 
         RowBox[{"QE", "[", 
          RowBox[{"\"\<dis\>\"", "/.", "dt"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"i", ",", "\"\<\[Angle]\>\""}], "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"i", ",", "\"\<src\>\""}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atoms", "=", 
           RowBox[{"GetEls", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{"atoma", "=", 
                RowBox[{"j", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
              "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"atomb", "=", 
                 RowBox[{"j", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"atomc", "=", 
                 RowBox[{"j", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "elsx"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"KeyExistsQ", "[", 
              RowBox[{
               RowBox[{"bonds", "[", "atomb", "]"}], "[", "\"\<ang\>\"", 
               "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"bonds", "[", "atomb", "]"}], "[", "\"\<ang\>\"", "]"}],
              "=", 
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"atoma", ",", "atomc", ",", 
                RowBox[{"QE", "[", 
                 RowBox[{"i", "/.", "dt"}], "]"}]}], "}"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"bonds", "[", "atomb", "]"}], "[", "\"\<ang\>\"", 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"atoma", ",", "atomc", ",", 
                RowBox[{"QE", "[", 
                 RowBox[{"i", "/.", "dt"}], "]"}]}], "}"}]}], "]"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"i", ",", "\"\<\[LongDash]\>\""}], "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"i", ",", "\"\<src\>\""}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atoms", "=", 
           RowBox[{"GetBond", "[", 
            RowBox[{"i", ",", "\"\<\[LongDash]\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"alist", "=", 
           RowBox[{"blist", "=", 
            RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"alist", ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"blist", ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "elsx"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Bupd", "[", 
              RowBox[{
               RowBox[{"k", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<len\>\"", ",", 
               RowBox[{"QE", "[", 
                RowBox[{"i", "/.", "dt"}], "]"}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Tuples", "[", 
               RowBox[{"{", 
                RowBox[{"alist", ",", "blist"}], "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"i", ",", "\"\<&\>\""}], "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"i", ",", "\"\<src\>\""}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atoms", "=", 
           RowBox[{"GetBond", "[", 
            RowBox[{"i", ",", "\"\<&\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"alist", "=", 
           RowBox[{"blist", "=", 
            RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"alist", ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"blist", ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "elsx"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Bupd", "[", 
              RowBox[{
               RowBox[{"k", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<dis\>\"", ",", 
               RowBox[{"QE", "[", 
                RowBox[{"i", "/.", "dt"}], "]"}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Tuples", "[", 
               RowBox[{"{", 
                RowBox[{"alist", ",", "blist"}], "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"i", ",", "\"\<#\>\""}], "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"i", ",", "\"\<src\>\""}], "]"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atoms", "=", 
           RowBox[{"GetBond", "[", 
            RowBox[{"i", ",", "\"\<#\>\""}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"alist", "=", 
           RowBox[{"blist", "=", 
            RowBox[{"{", "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"alist", ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"j", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", 
                RowBox[{"atoms", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"AppendTo", "[", 
                 RowBox[{"blist", ",", 
                  RowBox[{"j", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"j", ",", "elsx"}], "}"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Bupd", "[", 
              RowBox[{
               RowBox[{"k", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"k", "[", 
                RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<var\>\"", ",", 
               RowBox[{"QE", "[", 
                RowBox[{"i", "/.", "dt"}], "]"}]}], "]"}], ";"}], 
            "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Tuples", "[", 
               RowBox[{"{", 
                RowBox[{"alist", ",", "blist"}], "}"}], "]"}]}], "}"}]}], 
           "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"dt", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], "}"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"k", "=", 
        RowBox[{"i", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
            RowBox[{"bonds", "[", "k", "]"}], "[", "\"\<dt\>\"", "]"}], "]"}],
           "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"control", "=", 
           RowBox[{"{", 
            RowBox[{"False", ",", 
             RowBox[{"\"\<Bond for \>\"", "<>", "k"}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"control", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bonds", "[", "k", "]"}], "[", "j", "]"}], ",", 
                "\"\<dv\>\""}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"False", ",", 
               RowBox[{
               "\"\<Valency for \>\"", "<>", "k", "<>", "\"\< and \>\"", "<>",
                 "j"}]}], "}"}], ",", 
             RowBox[{"!", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bonds", "[", "k", "]"}], "[", "j", "]"}], ",", 
                "\"\<ln\>\""}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"False", ",", 
               RowBox[{
               "\"\<Length for \>\"", "<>", "k", "<>", "\"\<and\>\"", "<>", 
                "j"}]}], "}"}], ",", 
             RowBox[{"!", 
              RowBox[{"KeyExistsQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"bonds", "[", "k", "]"}], "[", "j", "]"}], ",", 
                "\"\<ds\>\""}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"False", ",", 
               RowBox[{
               "\"\<Dissociation for \>\"", "<>", "k", "<>", "\"\<and\>\"", "<>",
                 "j"}]}], "}"}], ",", "True", ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "\"\<\>\""}], "}"}]}], "]"}]}], ";"}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", 
           RowBox[{
            RowBox[{"bonds", "[", "k", "]"}], "[", "\"\<dt\>\"", "]"}]}], 
          "}"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"bonds", "[", "k", "]"}], "[", "\"\<tv\>\"", "]"}], "=", 
        RowBox[{"GetGr", "[", 
         RowBox[{"QM", "[", 
          RowBox[{"ElementData", "[", 
           RowBox[{
            RowBox[{"i", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<Group\>\""}], "]"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"bonds", "[", "k", "]"}], "[", "\"\<rr\>\"", "]"}], "=", 
        RowBox[{"QM", "[", 
         RowBox[{"ElementData", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<AtomicRadius\>\""}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"bonds", "[", "k", "]"}], "[", "\"\<ma\>\"", "]"}], "=", 
        RowBox[{"QM", "[", 
         RowBox[{"ElementData", "[", 
          RowBox[{
           RowBox[{"i", "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<AtomicWeight\>\""}], 
          "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "elsx"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";",
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Return", "[", "control", "]"}], ";"}], "\[IndentingNewLine]", 
   ")"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetMagnetism", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"APrint", "[", "\"\<Getting coefficients..\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"e2temp", "=", "e2"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LDtemp", "=", "LD"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Clear", "[", 
      RowBox[{"e2", ",", "LD", ",", "s", ",", "f", ",", "g", ",", "h"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"coef", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"sign", "=", 
         RowBox[{"Sign", "[", 
          RowBox[{"i", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"UD", "=", 
         RowBox[{"HoldForm", "[", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Kappa]", " ", "e2"}], "LD"], "*", 
           RowBox[{"dIon", "[", 
            RowBox[{"in", ",", 
             RowBox[{"mq", "/.", 
              RowBox[{"i", "\[Rule]", "in"}]}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"in", "=", 
         RowBox[{"LR", "[", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sign", "*", 
              RowBox[{"(", 
               RowBox[{"1", "+", "s"}], ")"}]}], ",", "0", ",", "0"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UDP", "=", 
         RowBox[{"QR", "[", "UD", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"in", "=", 
         RowBox[{"LR", "[", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"sign", "*", 
              RowBox[{"(", 
               RowBox[{"1", "-", "s"}], ")"}]}], ",", "0", ",", "0"}], 
            "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UDN", "=", 
         RowBox[{"QR", "[", "UD", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"in", "=", "i"}], ";", "\[IndentingNewLine]", 
        RowBox[{"UD0", "=", 
         RowBox[{"QR", "[", "UD", "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"UV", "=", 
         RowBox[{"UDN", "+", "UDP", "-", 
          RowBox[{"2", "UD0"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UP", "=", 
         FractionBox[
          RowBox[{"UDP", "-", "UDN"}], "2"]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"sf", "=", 
         RowBox[{"D", "[", 
          RowBox[{"UV", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "2"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sg", "=", 
         RowBox[{"D", "[", 
          RowBox[{"UP", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sh", "=", 
         RowBox[{"D", "[", 
          RowBox[{"UV", ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"s", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"f", "=", 
         RowBox[{"sf", "/", 
          SuperscriptBox["LD", "2"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"g", "=", 
         RowBox[{"sg", "/", 
          SuperscriptBox["LD", "3"]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"h", "=", 
         RowBox[{"sh", "/", 
          SuperscriptBox["LD", "4"]}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"dr", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              FractionBox["1", "2"]}], "*", 
             FractionBox["g", 
              SuperscriptBox["f", "2"]], "\[Micro]", " ", "H"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"2", " ", "g", " ", "h"}], 
                RowBox[{"3", " ", 
                 SuperscriptBox["f", "4"]}]], "-", 
               FractionBox[
                RowBox[{"5", 
                 SuperscriptBox["g", "3"]}], 
                RowBox[{"8", 
                 SuperscriptBox["f", "5"]}]]}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Micro]", " ", "H"}], ")"}], "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FractionBox[
                RowBox[{"185", 
                 SuperscriptBox["g", "3"], "h"}], 
                RowBox[{"48", 
                 SuperscriptBox["f", "7"]}]], "-", 
               FractionBox[
                RowBox[{"15", 
                 SuperscriptBox["g", "5"]}], 
                RowBox[{"8", 
                 SuperscriptBox["f", "8"]}]], "-", 
               FractionBox[
                RowBox[{"11", "g", " ", 
                 SuperscriptBox["h", "2"]}], 
                RowBox[{"8", 
                 SuperscriptBox["f", "6"]}]]}], ")"}], 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"\[Micro]", " ", "H"}], ")"}], "3"]}]}]}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dr", "=", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "2"]}], "*", 
          FractionBox["g", 
           SuperscriptBox["f", "2"]], "\[Micro]", " ", "H", " ", "cosl"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"eql", "=", 
         RowBox[{"\[Chi]", "\[Equal]", 
          FractionBox[
           RowBox[{"dr", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", "v"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"v", " ", "r"}], 
                RowBox[{"12", " ", "f", " ", "g"}]], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"5", 
                  SuperscriptBox["g", "2"]}], "-", 
                 RowBox[{"3", "f", " ", "h"}]}], ")"}]}]}], ")"}]}], "H"]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Lambda]", "=", 
         RowBox[{
          RowBox[{"ArcCos", "[", 
           RowBox[{"cosl", "/.", 
            RowBox[{"Solve", "[", 
             RowBox[{"eql", ",", "cosl"}], "]"}]}], "]"}], "/", 
          "\[Degree]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"coef", ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "g", ",", "h"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Clear", "[", 
         RowBox[{
         "s", ",", "sf", ",", "sg", ",", "sh", ",", "f", ",", "g", ",", "h"}],
          "]"}], ";"}], "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "KER"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"e2", "=", "e2temp"}], ";", "\[IndentingNewLine]", 
     RowBox[{"LD", "=", "LDtemp"}], ";"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Calculate", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"APrint", "[", "\"\<Calculating..\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SOL", "=", 
      RowBox[{"{", 
       RowBox[{"1000", ",", 
        RowBox[{"{", "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"SOLB", "=", "SOL"}], ";", "\[IndentingNewLine]", 
     RowBox[{"prntclc", "=", "False"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"rlx", "=", 
         RowBox[{"ParseRules", "[", "i", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"iter", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Clear", "@@", 
         RowBox[{"rlx", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"APrint", "[", 
         RowBox[{"\"\<Pending rules: \>\"", ",", "i"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"While", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SOL", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ">", "minerr"}], "&&", 
           RowBox[{"iter", "<", "tries"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Quiet", "[", 
            RowBox[{"SOL", "=", 
             RowBox[{"FindMinimum", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"EQ", ",", 
                 RowBox[{"rlx", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"QR", "[", 
                RowBox[{"rlx", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
               RowBox[{"MaxIterations", "\[Rule]", "5000"}], ",", 
               RowBox[{"AccuracyGoal", "\[Rule]", "10"}]}], "]"}]}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<SOLC: \>\"", ",", "SOL"}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"prntclc", ",", 
             RowBox[{"APrint", "[", 
              RowBox[{"\"\<SOLC: \>\"", ",", "SOL"}], "]"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Do", "[", 
              RowBox[{
               RowBox[{"QS", "[", 
                RowBox[{"i", ",", 
                 RowBox[{
                  RowBox[{"QG", "[", "i", "]"}], "/.", 
                  RowBox[{"SOL", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"rlx", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"iter", "=", 
            RowBox[{"iter", "+", "1"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Clear", "@@", 
            RowBox[{"rlx", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"coef", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}], "<=", "0"}], "||", 
                  RowBox[{
                   RowBox[{"coef", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}], "<=", "0"}]}], 
                 ")"}], "&&", 
                RowBox[{"TestMode", "\[Equal]", "0"}]}], ",", 
               RowBox[{"SOL", "=", 
                RowBox[{"{", 
                 RowBox[{"1000", ",", 
                  RowBox[{"{", "}"}]}], "}"}]}]}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SOL", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "<", 
              RowBox[{"SOLB", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"SOLB", "=", "SOL"}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"SOL", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "<", "minerr"}], ",", 
          RowBox[{"Break", "[", "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
       ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "rules"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
     ";"}], "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ApplyResults", "[", "]"}], ":=", 
   RowBox[{"(", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"APrint", "[", "\"\<Applying Results..\>\"", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Clear", "@@", 
      RowBox[{"rlx", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"APrint", "[", 
      RowBox[{"\"\<Solval: \>\"", ",", 
       RowBox[{"SOL", "=", "SOLB"}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"QS", "[", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"QG", "[", "i", "]"}], "/.", 
          RowBox[{"SOL", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"rlx", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"APrint", "[", 
      RowBox[{"\"\<Acc:\>\"", ",", "AQLIST"}], "]"}], ";"}], 
    "\[IndentingNewLine]", ")"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PrintGeo", "[", "]"}], ":=", 
  RowBox[{"(", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"APrint", "[", "\"\<-----Geogebra output:-----\>\"", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"GOpen", "[", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"GP", "[", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"bonds", "[", "i", "]"}], "[", "\"\<pos\>\"", "]"}], ",", 
         "\"\<Red\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"GPL", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"bonds", "[", "i", "]"}], "[", "\"\<eles\>\"", "]"}], ",", 
         "\"\<Black\>\"", ",", 
         RowBox[{"i", "<>", "\"\<e\>\""}]}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"i", ",", "objs"}], "}"}]}], "\[IndentingNewLine]", "]"}], ";",
     "\[IndentingNewLine]", 
    RowBox[{"GClose", "[", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dv", "<", "3"}], ",", 
       RowBox[{
        RowBox[{"A3", "=", "\"\<X\>\""}], ";", 
        RowBox[{"B3", "=", "\"\<X\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"dv", "<", "2"}], ",", 
       RowBox[{
        RowBox[{"A2", "=", "\"\<X\>\""}], ";", 
        RowBox[{"B2", "=", "\"\<X\>\""}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RXX", "[", "x_", "]"}], ":=", 
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"10", "x"}], ",", "0.000000001"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"RX", "[", "x_", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", " ", "@", "x"}], "\[Equal]", "String"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"(", 
            RowBox[{"{", 
             RowBox[{"\"\<X\>\"", ",", "\"\<X\>\"", ",", "\"\<X\>\""}], "}"}],
             ")"}], "]"}]}], "]"}], ";", 
        RowBox[{"(", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IQ", "[", 
            RowBox[{"RXX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"IQ", "[", 
            RowBox[{"RXX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}], ",", 
           RowBox[{"IQ", "[", 
            RowBox[{"RXX", "[", 
             RowBox[{"x", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], "}"}], ")"}]}], 
       ")"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"A1", "=", 
      RowBox[{"RX", "[", "A1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A2", "=", 
      RowBox[{"RX", "[", "A2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"A3", "=", 
      RowBox[{"RX", "[", "A3", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B1", "=", 
      RowBox[{"RX", "[", "B1", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B2", "=", 
      RowBox[{"RX", "[", "B2", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"B3", "=", 
      RowBox[{"RX", "[", "B3", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"j", "=", 
      RowBox[{
       FractionBox["1", "mA"], "+", 
       FractionBox["1", "mB"]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]A", "=", 
      RowBox[{"c", 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Omega]B", "=", 
      RowBox[{"c", 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Micro]A", "=", 
      RowBox[{
       FractionBox["e1", "2"], "*", "4", 
       SuperscriptBox["LD", "2"], 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Micro]B", "=", 
      RowBox[{
       FractionBox["e1", "2"], "*", "4", 
       SuperscriptBox["LD", "2"], 
       SqrtBox[
        RowBox[{
         RowBox[{"coef", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], "*", "j"}]]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalDelta]\[Micro]", "=", 
      RowBox[{"Abs", "[", 
       RowBox[{"\[Micro]A", "-", "\[Micro]B"}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", ")"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7848114955258503`*^9, 3.784811532821766*^9}, {
   3.784811566313727*^9, 3.7848116005336857`*^9}, {3.784811643965646*^9, 
   3.784811733417571*^9}, 3.784811778077479*^9, {3.784811908769329*^9, 
   3.7848119162253428`*^9}, {3.784813081565324*^9, 3.78481308625732*^9}, {
   3.7848141976234612`*^9, 3.784814218255414*^9}, 3.784814378029768*^9, {
   3.784815814827255*^9, 3.784815875671184*^9}, {3.784816099842952*^9, 
   3.784816106262955*^9}, {3.784816447079745*^9, 3.7848164504597793`*^9}, 
   3.7848172673077126`*^9, {3.7848175689125905`*^9, 3.784817661434052*^9}, {
   3.784817801467346*^9, 3.7848178185193677`*^9}, 3.78584521129819*^9, {
   3.785845511967913*^9, 3.7858455123758216`*^9}, {3.7858455437369566`*^9, 
   3.7858455870351696`*^9}, {3.785845710830409*^9, 3.785845711860656*^9}, 
   3.78584768316004*^9, 3.7858482286626062`*^9, {3.78781168421297*^9, 
   3.7878117158928924`*^9}, {3.7878163123559227`*^9, 3.787816312701996*^9}, {
   3.7879869820219145`*^9, 3.7879870516239276`*^9}, {3.78798713804226*^9, 
   3.787987172065691*^9}, 3.7880081567067213`*^9, {3.78801733230276*^9, 
   3.788017537226756*^9}, {3.788017571135079*^9, 3.7880176214016857`*^9}, {
   3.7880176971101985`*^9, 3.7880177901653814`*^9}, {3.7880178380502973`*^9, 
   3.7880179071375756`*^9}, {3.7880179509194655`*^9, 3.788018097055094*^9}, 
   3.7880650698140016`*^9, {3.7880652089176426`*^9, 3.788065305640698*^9}, {
   3.788065658586488*^9, 3.7880656588059263`*^9}, {3.7880662538104253`*^9, 
   3.788066257080681*^9}, {3.788066296193936*^9, 3.7880662966566973`*^9}, {
   3.7880664841750755`*^9, 3.7880666209195747`*^9}, {3.7880668748978424`*^9, 
   3.788066988257506*^9}, {3.7880670256615996`*^9, 3.788067084908166*^9}, {
   3.788067115990044*^9, 3.788067119545537*^9}, {3.7880671731154184`*^9, 
   3.7880671953629236`*^9}, {3.7880672427463875`*^9, 
   3.7880672527117367`*^9}, {3.7880675541888494`*^9, 3.7880675832480316`*^9}, 
   3.7880676723246813`*^9, {3.788068822831566*^9, 3.788068834753684*^9}, {
   3.788068986375286*^9, 3.7880690120427866`*^9}, {3.788069354986252*^9, 
   3.788069455099353*^9}, {3.78807234132927*^9, 3.7880723607274284`*^9}, {
   3.7880731283327274`*^9, 3.788073243880273*^9}, {3.788073319149774*^9, 
   3.7880733256972632`*^9}, {3.788073416200502*^9, 3.788073421118351*^9}, 
   3.7880734679780397`*^9, {3.7880735697644496`*^9, 3.788073571497817*^9}, {
   3.788073701869273*^9, 3.7880737024447355`*^9}, {3.7880738926927543`*^9, 
   3.788073897942712*^9}, {3.788074025767095*^9, 3.7880740260982084`*^9}, {
   3.789545028276018*^9, 3.7895450604482875`*^9}, {3.7895450954816008`*^9, 
   3.789545159670637*^9}, {3.789545206069584*^9, 3.7895452065772195`*^9}, {
   3.7895452569126205`*^9, 3.7895452593660336`*^9}, {3.7895452965498056`*^9, 
   3.7895453502342453`*^9}, {3.789545423558072*^9, 3.7895454654876037`*^9}, {
   3.7895455199183702`*^9, 3.789545638807918*^9}, {3.789545688260644*^9, 
   3.789545709753196*^9}, 3.789545870831827*^9, {3.7895468912922287`*^9, 
   3.789546902625952*^9}, {3.789548408997733*^9, 3.7895484098684006`*^9}, {
   3.789735349342125*^9, 3.7897353564610043`*^9}, {3.7897360237203827`*^9, 
   3.7897360539804344`*^9}, {3.789736646698618*^9, 3.7897367186591935`*^9}, {
   3.789736754537469*^9, 3.7897368017153134`*^9}, 3.7897368503301363`*^9, {
   3.78973689199294*^9, 3.7897369079743395`*^9}, {3.7897369597403183`*^9, 
   3.7897369599667125`*^9}, {3.7897384728912363`*^9, 
   3.7897384981707726`*^9}, {3.7897385847801833`*^9, 3.789738609113124*^9}, 
   3.7897933573667073`*^9, {3.789795671740207*^9, 3.7897956873313837`*^9}, {
   3.789796328056323*^9, 3.789796331979082*^9}, {3.789796439324927*^9, 
   3.7897964463395596`*^9}, {3.7897966460295715`*^9, 3.7897968986774106`*^9}, 
   3.7897972630524607`*^9, {3.7902344593666935`*^9, 3.7902344597855835`*^9}, {
   3.790234700606044*^9, 3.7902347402435665`*^9}, {3.790235276572239*^9, 
   3.7902353093854885`*^9}, {3.7902374668223968`*^9, 3.790237468443043*^9}, {
   3.790237656428301*^9, 3.7902376725466185`*^9}, {3.790238219600829*^9, 
   3.7902382199708157`*^9}, {3.7902390846577463`*^9, 3.790239140192999*^9}, {
   3.790240079397195*^9, 3.7902400915995903`*^9}, {3.7905742364996924`*^9, 
   3.790574251106636*^9}, {3.7905745161915655`*^9, 3.790574609967236*^9}, {
   3.79057472469662*^9, 3.790574727889077*^9}, {3.790574805168687*^9, 
   3.7905748547161813`*^9}, {3.79057489891197*^9, 3.790574958269238*^9}, {
   3.7905749925302057`*^9, 3.7905750181467023`*^9}, {3.790576229850666*^9, 
   3.7905762300431213`*^9}, 3.7905764434554615`*^9, {3.7905769660430264`*^9, 
   3.790576992423501*^9}, {3.790577342306394*^9, 3.790577367020281*^9}, {
   3.790577726077265*^9, 3.7905777324532146`*^9}, {3.790578752478568*^9, 
   3.7905787742972217`*^9}, {3.7905791206778727`*^9, 3.7905791728647723`*^9}, 
   3.790579263326013*^9, {3.791872248130747*^9, 3.7918723368465657`*^9}, {
   3.791872444702146*^9, 3.7918724656112976`*^9}, {3.7918725059733744`*^9, 
   3.791872566395815*^9}, {3.79187261289648*^9, 3.791872614509194*^9}, 
   3.791872850542053*^9, {3.7918728858976336`*^9, 3.7918729154416056`*^9}, {
   3.791872959159712*^9, 3.791872967384718*^9}, {3.7918732337943735`*^9, 
   3.7918732603204193`*^9}, {3.7918733325660505`*^9, 3.7918733422940392`*^9}, 
   3.791874130338929*^9, {3.7918743109519987`*^9, 3.7918743493682747`*^9}, {
   3.7918745016312776`*^9, 3.791874503595005*^9}, {3.7918750064549437`*^9, 
   3.791875071795233*^9}, {3.7918751344686804`*^9, 3.791875239330697*^9}, {
   3.791875803195527*^9, 3.7918758576199803`*^9}, {3.7918759294080286`*^9, 
   3.791876005894517*^9}, {3.791876127412774*^9, 3.791876191687933*^9}, {
   3.7918762544640856`*^9, 3.791876461005718*^9}, {3.7918764923020363`*^9, 
   3.7918765200189304`*^9}, {3.7918766388831134`*^9, 3.791876678078326*^9}, {
   3.791876727055375*^9, 3.7918767553626547`*^9}, {3.791877046551742*^9, 
   3.791877102009491*^9}, {3.7918771613411884`*^9, 3.791877162176978*^9}, 
   3.7918774047553625`*^9, {3.791877443282322*^9, 3.7918775488590574`*^9}, {
   3.791877679674247*^9, 3.7918777587966857`*^9}, {3.791878304636444*^9, 
   3.791878305552993*^9}, {3.7918785817564936`*^9, 3.7918785828685207`*^9}, {
   3.7918786271690416`*^9, 3.7918786326095233`*^9}, {3.791879738726202*^9, 
   3.791879749591171*^9}, {3.791879842127722*^9, 3.79187989583013*^9}, {
   3.7920409804433594`*^9, 3.792041034329279*^9}, {3.7920410861846247`*^9, 
   3.7920411240563617`*^9}, {3.792041206808098*^9, 3.7920412505381947`*^9}, {
   3.792041969466813*^9, 3.7920420514585805`*^9}, 3.7920422616525555`*^9, {
   3.7920423758043633`*^9, 3.792042487054865*^9}, {3.7920425475142074`*^9, 
   3.7920425864201784`*^9}, {3.792042750479713*^9, 3.7920428191471376`*^9}, {
   3.7920428569370823`*^9, 3.792043290428006*^9}, {3.7920433300300875`*^9, 
   3.7920434946351137`*^9}, {3.7920435292842216`*^9, 3.792043609942563*^9}, {
   3.792043641472248*^9, 3.792043881242141*^9}, 3.7920439115890245`*^9, {
   3.792044044782859*^9, 3.7920440474257917`*^9}, {3.792044170555563*^9, 
   3.7920441861638546`*^9}, {3.792044377188672*^9, 3.7920443928906927`*^9}, {
   3.79204460886053*^9, 3.7920446103176336`*^9}, {3.7920446423709292`*^9, 
   3.792044821497991*^9}, {3.7920450040531054`*^9, 3.7920450490876827`*^9}, {
   3.79204509626357*^9, 3.7920451723102055`*^9}, {3.7920452392362833`*^9, 
   3.79204527485505*^9}, {3.7920457829644127`*^9, 3.7920457861678743`*^9}, {
   3.7920458215445867`*^9, 3.7920458712207336`*^9}, {3.7920460690557547`*^9, 
   3.7920460713925056`*^9}, {3.7920464731263714`*^9, 3.792046492153489*^9}, {
   3.792046720551118*^9, 3.7920467283602376`*^9}, {3.7920467590521994`*^9, 
   3.7920467726977134`*^9}, {3.7920468073530226`*^9, 
   3.7920469514791093`*^9}, {3.792047029771738*^9, 3.7920470573490276`*^9}, {
   3.792047092957822*^9, 3.792047171820922*^9}, {3.7920472272337255`*^9, 
   3.7920473049269867`*^9}, {3.7920473387974243`*^9, 3.792047385168454*^9}, {
   3.7920474342283487`*^9, 3.7920474836342716`*^9}, {3.7920475229331665`*^9, 
   3.7920475787938304`*^9}, {3.7920479488303843`*^9, 3.792047981139995*^9}, {
   3.792048115979456*^9, 3.7920481523981037`*^9}, {3.792048188959338*^9, 
   3.792048197742835*^9}, {3.792048309907979*^9, 3.7920483169122777`*^9}, {
   3.792048469276803*^9, 3.792048471619994*^9}, {3.7920485121664486`*^9, 
   3.7920486024271326`*^9}, {3.7920488568659*^9, 3.792049144832706*^9}, {
   3.7920503561049304`*^9, 3.7920503579101048`*^9}, {3.792050400235957*^9, 
   3.7920505734487867`*^9}, {3.792050621557153*^9, 3.792050659389026*^9}, 
   3.7920509966751785`*^9, {3.792164565147579*^9, 3.7921645687618113`*^9}, {
   3.7921646779292345`*^9, 3.7921646935677*^9}, {3.7922141109072857`*^9, 
   3.792214116698832*^9}, {3.7922143960079727`*^9, 3.792214608033078*^9}, {
   3.7922195130224705`*^9, 3.7922195305236874`*^9}, {3.792219572579221*^9, 
   3.792219573631413*^9}, 3.79222247235686*^9, {3.792222665320982*^9, 
   3.792222714320962*^9}, {3.792222761001147*^9, 3.792222861288993*^9}, {
   3.7922234692358932`*^9, 3.792223471230618*^9}, {3.7922247156704288`*^9, 
   3.79222472559591*^9}, {3.792224904500132*^9, 3.7922249258590193`*^9}, {
   3.7922249587939873`*^9, 3.7922249641107407`*^9}, 3.792225014816163*^9, {
   3.7922251647373223`*^9, 3.7922251706365476`*^9}, {3.7922252206474123`*^9, 
   3.7922252521222534`*^9}, {3.7922254025378723`*^9, 3.792225556589961*^9}, {
   3.792225590183139*^9, 3.7922256549190764`*^9}, {3.7922256849726863`*^9, 
   3.7922257313277407`*^9}, {3.7922258659760485`*^9, 3.792225870733329*^9}, {
   3.792225996249341*^9, 3.7922259969265304`*^9}, {3.792226132924507*^9, 
   3.7922262731156597`*^9}, {3.79222637720514*^9, 3.7922264030360527`*^9}, {
   3.7923090290013046`*^9, 3.792309034845678*^9}, {3.792309566734269*^9, 
   3.7923095900619135`*^9}, {3.7923101287726507`*^9, 
   3.7923101340465803`*^9}, {3.792310200943677*^9, 3.792310307825347*^9}, {
   3.7923107852780914`*^9, 3.792310791647032*^9}, {3.7923108428832016`*^9, 
   3.7923108578212595`*^9}, {3.7923108973276863`*^9, 3.792310931446458*^9}, {
   3.792310964142597*^9, 3.79231106241442*^9}, {3.792311130816349*^9, 
   3.792311131482542*^9}, {3.792311162655098*^9, 3.79231119326136*^9}, {
   3.7923112637887816`*^9, 3.7923112648509684`*^9}, 3.7923113326313667`*^9, {
   3.7923113670992355`*^9, 3.792311368875456*^9}, {3.7923114723759317`*^9, 
   3.792311474053447*^9}, {3.792311768561548*^9, 3.7923117801196423`*^9}, {
   3.7923118223771453`*^9, 3.792311822829934*^9}, 3.792312204563365*^9, {
   3.7923155476928997`*^9, 3.79231556315755*^9}, 3.792315821502302*^9, {
   3.792316348855301*^9, 3.7923164015823183`*^9}, {3.792317316922264*^9, 
   3.7923176525874987`*^9}, {3.792501228048765*^9, 3.7925013118458633`*^9}, {
   3.792502484053982*^9, 3.792502489980136*^9}, {3.79250653183694*^9, 
   3.792506545820549*^9}, {3.792506909956273*^9, 3.7925069128375683`*^9}, {
   3.7925070692107124`*^9, 3.7925070697542596`*^9}, {3.792508388645525*^9, 
   3.7925084072717214`*^9}},ExpressionUUID->"ad78d8e7-3118-4dbb-a100-\
d764b1c9bd1b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.792041048471465*^9, 3.792041056924863*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"19af803d-44d6-4d51-9836-be83fd7c039e"]
},
WindowSize->{1436, 872},
WindowMargins->{{Automatic, 115}, {-136, Automatic}},
Magnification:>1.2 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 52383, 1192, 6405, "Input",ExpressionUUID->"ad78d8e7-3118-4dbb-a100-d764b1c9bd1b"],
Cell[52944, 1214, 170, 2, 35, "Input",ExpressionUUID->"19af803d-44d6-4d51-9836-be83fd7c039e"]
}
]
*)

